version: '3.0'

services: 
    tomcat1:
        container_name: tomcat_1
        build: 
            context: ./tomcat
            args: 
                index: ./index1.jsp
        volumes: 
            - tomcat_log1:/usr/local/tomcat/logs
    tomcat2: 
        container_name: tomcat_2
        build: 
            context: ./tomcat
            args: 
                index: ./index2.jsp
        volumes: 
            - tomcat_log2:/usr/local/tomcat/logs
    mynginx: 
        container_name: proxy
        build: 
            context: ./nginx
        ports: 
            - "80:80"
        volumes: 
            - nginx_log:/var/log/nginx
networks: 
    default:
        external: 
            name: devops
volumes: 
    nginx_log:
        external: true
    tomcat_log1:
        external: true
    tomcat_log2:
        external: true
